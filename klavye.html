<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Osmanlıca Klavye + Wordle Mini Oyun + El Yazısı + PDF</title>

  <!-- Bootstrap ve ikonlar -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #1a3b5d, #3f5b82);
      color: white;
      min-height: 100vh;
      padding: 1rem;
    }
    /* Tema */
    body.light-theme {
      background: #f8f9fa;
      color: #212529;
    }
    /* Klavye Butonları */
    #klavye .btn {
      font-size: 1.8rem;
      min-width: 50px;
      height: 50px;
      line-height: 38px;
    }
    /* Harf Bilgi Kutusu */
    #harfBilgiKutusu {
      background-color: rgba(255 255 255 / 0.2);
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 1rem;
      direction: rtl;
    }
    /* Output Alanı */
    #outputArea {
      direction: rtl;
      font-size: 2rem;
      min-height: 100px;
      background-color: rgba(255 255 255 / 0.1);
      border: none;
      border-radius: 5px;
      padding: 10px;
      margin-bottom: 1rem;
      color: inherit;
      outline: none;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    /* Yazım Alıştırması Kart */
    .card {
      color: #212529;
    }
    /* Latin çıktı ve istatistik */
    #latinCikti {
      font-weight: bold;
    }
    /* Wordle Stilleri */
    .wordle-box {
      display: grid;
      grid-template-columns: repeat(5, 50px);
      gap: 5px;
      margin-bottom: 10px;
    }
    .letter-box {
      width: 50px;
      height: 50px;
      text-transform: uppercase;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      line-height: 50px;
      border-radius: 5px;
      user-select: none;
    }
    .correct { background-color: #28a745; color: white; border: none; }
    .misplaced { background-color: #ffc107; color: black; border: none; }
    .incorrect { background-color: #dee2e6; color: black; border: none; }
    /* Buton Ana Sayfa */
    .back-home-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      font-size: 1.6rem;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      background-color: #c9a343;
      color: #000;
      border: none;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .back-home-btn:hover {
      transform: scale(1.1);
      background-color: #e5c06d;
      color: #000;
    }
    /* El Yazısı Canvas */
    #drawCanvas {
      border: 1px solid #ccc;
      background: white;
      touch-action: none;
      display: block;
      margin: auto;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <h2 class="text-center text-warning mb-3">📱 Osmanlıca Dokunmatik Klavye</h2>

  <!-- Output -->
  <div id="outputArea" contenteditable="true" spellcheck="false" aria-label="Metin girişi alanı"></div>

  <!-- Harf Bilgisi -->
  <div id="harfBilgiKutusu" class="alert alert-info d-none" style="direction:rtl;"></div>

  <!-- Klavye -->
  <div id="klavye" class="text-center mb-4">
    <div class="d-flex flex-wrap justify-content-center gap-2">
      <!-- Harfler JS ile eklenecek -->
    </div>
  </div>

  <!-- Yazım Alıştırması Kart -->
  <div class="card bg-light text-dark mb-3">
    <div class="card-body">
      <h5>📝 Yazım Alıştırması:</h5>
      <p>Bu kelimeyi yaz: <strong id="hedefKelime" style="font-size:1.5rem;">---</strong></p>
      <button onclick="kontrolAlistirma()" class="btn btn-success btn-sm">Kontrol Et</button>
      <span id="sonucMesaji" class="ms-2"></span>
      <button onclick="yeniAlistirmaKelime()" class="btn btn-outline-secondary btn-sm float-end">Yeni Kelime</button>
    </div>
  </div>

  <!-- Latin Karşılığı ve İstatistik -->
  <div class="mb-3">
    <div><strong>🔤 Latin Karşılığı:</strong> <span id="latinCikti"></span></div>
    <div>
      <strong>📈 Harf Sayısı:</strong> <span id="harfSayisi">0</span> / 
      <strong>Kelime Sayısı:</strong> <span id="kelimeSayisi">0</span>
    </div>
    <div>
      <strong>✍️ Çizim İstatistikleri:</strong> <span id="cizimPiksel">0</span> piksel çizildi.
    </div>
  </div>

  <!-- Yazım Kontrolü -->
  <div class="mb-3">
    <button class="btn btn-info" onclick="yazimKontrol()">✔️ Yazım Kontrolü</button>
    <div id="yazimSonuc" class="mt-2"></div>
  </div>

  <!-- Tema Değiştirici -->
  <div class="mb-4">
    <button class="btn btn-warning" onclick="temaDegistir()">🌓 Tema Değiştir</button>
  </div>

  <!-- El Yazısı Çizim Alanı -->
  <div class="mb-4 text-center">
    <h5>✍️ El Yazısı Çizim Alanı</h5>
    <canvas id="drawCanvas" width="350" height="150"></canvas>
    <div class="mt-2">
      <button class="btn btn-secondary btn-sm" onclick="clearCanvas()">Temizle</button>
      <button class="btn btn-primary btn-sm" onclick="indirPDF()">PDF Olarak İndir</button>
    </div>
  </div>

  <!-- Wordle Mini Oyun -->
  <div class="border rounded p-3 mb-4" style="background-color: #222; color: white;">
    <h4>🎮 Wordle Tarzı Mini Oyun</h4>
    <div class="mb-2">
      <button class="btn btn-success btn-sm" onclick="baslatRastgele()">🎲 Rastgele Kelime ile Başla</button>
      <button class="btn btn-secondary btn-sm" onclick="baslatKullanici()">✍️ Gizli Kelimeyi Ben Belirleyeceğim</button>
    </div>
    <div class="mb-2">
      <input type="text" id="wordleInput" class="form-control" maxlength="5" placeholder="5 harfli tahmin..." aria-label="Wordle tahmin girişi" />
    </div>
    <button class="btn btn-primary mb-2" onclick="tahminEt()">Tahmin Et</button>
    <div id="wordleContainer"></div>
    <div id="wordleMessage" class="mt-2"></div>
    <button class="btn btn-secondary d-none" id="yenidenBtn" onclick="oyunuYenidenBaslat()">🔁 Oyunu Yeniden Başlat</button>
  </div>

  <!-- Ana Sayfa Butonu -->
  <a href="index.html" class="btn btn-warning back-home-btn" title="Ana Sayfaya Dön">
    <i class="bi bi-house-door-fill"></i>
  </a>

  <!-- jsPDF CDN (PDF oluşturmak için) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // --- 1. Harf Bilgileri ve Klavye Oluşturma ---
    const harfBilgileri = {
      "ا": "Elif – Genellikle başta kullanılır.",
      "ب": "Be – Dudak sesi. Başta: بـ Ortada: ـبـ Sonda: ـب",
      "ت": "Te – Diş sesi.",
      "ث": "Se – İnce diş sesi.",
      "ج": "Cim – Boğazdan gelen ‘c’ sesi.",
      "ح": "Ha – Hırıltılı ‘h’ sesi.",
      "خ": "Hı – Kalın ‘h’ sesi.",
      "د": "Dal – D sesi.",
      "ذ": "Zel – Z sesi (ince).",
      "ر": "Re – R sesi.",
      "ز": "Ze – Sert Z.",
      "س": "Sin – S sesi.",
      "ش": "Şin – Ş sesi.",
      "ص": "Sad – Kalın S.",
      "ض": "Dad – Kalın D.",
      "ط": "Tı – Kalın T.",
      "ظ": "Zı – Kalın Z.",
      "ع": "Ayn – Boğazdan gelen ses.",
      "غ": "Gayn – Gırtlaktan gelen g sesi.",
      "ف": "Fe – F sesi.",
      "ق": "Kaf – Kalın K.",
      "ك": "Kef – İnce K.",
      "ل": "Lam – L sesi.",
      "م": "Mim – M sesi.",
      "ن": "Nun – N sesi.",
      "ه": "He – H sesi.",
      "و": "Vav – V veya U/O sesi.",
      "ي": "Ye – Y sesi.",
      "ء": "Hemze – Durak sesi.",
      "،": "Virgül",
      ".": "Nokta",
      "◀": "Silme tuşu"
    };
    const harfler = Object.keys(harfBilgileri);
    const klavyeDiv = document.querySelector("#klavye .d-flex");
    const output = document.getElementById("outputArea");
    const harfBilgiKutusu = document.getElementById("harfBilgiKutusu");

    // Klavye Butonları Ekleme
    function klavyeOlustur() {
      const container = document.querySelector("#klavye .d-flex");
      container.innerHTML = "";
      harfler.forEach(harf => {
        const btn = document.createElement("button");
        btn.className = "btn btn-outline-light";
        btn.style.fontSize = "1.8rem";
        btn.textContent = harf;
        btn.onclick = () => {
          if (harf === "◀") {
            output.innerText = output.innerText.slice(0, -1);
          } else {
            output.innerText += harf;
          }
          harfBilgiKutusu.classList.remove("d-none");
          harfBilgiKutusu.textContent = harfBilgileri[harf] || "";
          guncelleLatinVeIst();
        };
        container.appendChild(btn);
      });
    }
    klavyeOlustur();

    // --- 2. Yazım Alıştırması ---
    const kelimeler = ["كتاب", "مدرسة", "قلم", "مكتبة", "تاريخ", "لغة", "مسجد", "سؤال"];
    const hedefKelimeSpan = document.getElementById("hedefKelime");
    const sonucMesajiSpan = document.getElementById("sonucMesaji");

    function yeniAlistirmaKelime() {
      const kelime = kelimeler[Math.floor(Math.random() * kelimeler.length)];
      hedefKelimeSpan.textContent = kelime;
      sonucMesajiSpan.textContent = "";
      output.innerText = "";
      guncelleLatinVeIst();
    }
    yeniAlistirmaKelime();

    function kontrolAlistirma() {
      const giris = output.innerText.trim();
      if (giris === hedefKelimeSpan.textContent.trim()) {
        sonucMesajiSpan.textContent = "✅ Doğru yazdınız!";
        sonucMesajiSpan.className = "text-success fw-bold";
      } else {
        sonucMesajiSpan.textContent = "❌ Yanlış! Tekrar deneyin.";
        sonucMesajiSpan.className = "text-danger fw-bold";
      }
    }

    // --- 3. Latin Karşılığı ve İstatistik Paneli ---
    function guncelleLatinVeIst() {
      const metin = output.innerText.trim();
      // Basit harf eşleme (harf -> latin)
      const harfLatin = {
        "ا": "a", "ب": "b", "ت": "t", "ث": "s", "ج": "c", "ح": "h", "خ": "x",
        "د": "d", "ذ": "z", "ر": "r", "ز": "z", "س": "s", "ش": "ş", "ص": "s",
        "ض": "d", "ط": "t", "ظ": "z", "ع": "ʿ", "غ": "ğ", "ف": "f", "ق": "k",
        "ك": "k", "ل": "l", "م": "m", "ن": "n", "ه": "h", "و": "v", "ي": "y",
        "ء": "'", "،": ",", ".": ".", " ": " "
      };
      let latin = "";
      for (const ch of metin) {
        latin += harfLatin[ch] ?? ch;
      }
      document.getElementById("latinCikti").textContent = latin;

      // İstatistikler
      document.getElementById("harfSayisi").textContent = metin.replace(/\s/g, "").length;
      document.getElementById("kelimeSayisi").textContent = metin.trim() === "" ? 0 : metin.trim().split(/\s+/).length;
    }

    // --- 4. Akıllı Yazım Kontrolü ---
    function yazimKontrol() {
      const metin = output.innerText.trim();
      const hataKutusu = document.getElementById("yazimSonuc");
      const boslukVar = /\s/.test(metin);
      const osmanlicaHarfVar = /[ا-ي]/.test(metin);
      let mesajlar = [];

      if (metin.length < 3) mesajlar.push("Yazı çok kısa.");
      if (!boslukVar) mesajlar.push("En az bir boşluk olmalı.");
      if (!osmanlicaHarfVar) mesajlar.push("Osmanlıca harfler kullanılmalı.");

      if (mesajlar.length === 0) {
        hataKutusu.textContent = "✅ Yazımda önemli hata bulunamadı.";
        hataKutusu.className = "text-success fw-bold";
      } else {
        hataKutusu.textContent = mesajlar.join(" ");
        hataKutusu.className = "text-danger fw-bold";
      }
    }

    // --- 5. Tema Değiştirici ---
    function temaDegistir() {
      document.body.classList.toggle("light-theme");
    }

    // --- 6. Wordle Mini Oyun ---
    const wordleKelimeListesi = ["aklen", "kitap", "ilham", "devam", "hilal", "harbi", "derin", "kasir", "nazir", "serin"];
    let gizliKelime = "";
    let tahminSayisi = 0;
    const maxTahmin = 6;

    function temizleWordle() {
      document.getElementById("wordleContainer").innerHTML = "";
      const msg = document.getElementById("wordleMessage");
      msg.className = "";
      msg.textContent = "";
      document.getElementById("yenidenBtn").classList.add("d-none");
      tahminSayisi = 0;
    }

    function baslatRastgele() {
      gizliKelime = wordleKelimeListesi[Math.floor(Math.random() * wordleKelimeListesi.length)].toLowerCase();
      temizleWordle();
      document.getElementById("wordleMessage").textContent = "🎯 Kelime seçildi, tahmin etmeye başlayabilirsin!";
    }

    function baslatKullanici() {
      const kelime = prompt("5 harfli gizli kelimeyi girin:")?.toLowerCase();
      if (kelime && kelime.length === 5) {
        gizliKelime = kelime;
        temizleWordle();
        document.getElementById("wordleMessage").textContent = "🎯 Gizli kelime ayarlandı, tahmin etmeye başlayabilirsin!";
      } else {
        alert("5 harfli bir kelime girin!");
      }
    }

    function tahminEt() {
      const input = document.getElementById("wordleInput");
      const tahmin = input.value.trim().toLowerCase();
      const msg = document.getElementById("wordleMessage");
      if (tahmin.length !== 5) {
        msg.textContent = "Lütfen 5 harfli bir kelime giriniz!";
        msg.className = "text-danger";
        return;
      }
      tahminSayisi++;
      const container = document.getElementById("wordleContainer");

      // Yeni satır oluştur
      const satir = document.createElement("div");
      satir.className = "wordle-box";

      // Her harfi kontrol et
      for (let i = 0; i < 5; i++) {
        const kutu = document.createElement("div");
        kutu.className = "letter-box";

        if (tahmin[i] === gizliKelime[i]) {
          kutu.classList.add("correct");
        } else if (gizliKelime.includes(tahmin[i])) {
          kutu.classList.add("misplaced");
        } else {
          kutu.classList.add("incorrect");
        }
        kutu.textContent = tahmin[i];
        satir.appendChild(kutu);
      }
      container.appendChild(satir);
      input.value = "";
      input.focus();

      if (tahmin === gizliKelime) {
        msg.textContent = `🎉 Tebrikler! Kelimeyi ${tahminSayisi} tahminde buldunuz.`;
        msg.className = "text-success fw-bold";
        document.getElementById("yenidenBtn").classList.remove("d-none");
      } else if (tahminSayisi >= maxTahmin) {
        msg.textContent = `😞 Hakkınız bitti. Gizli kelime: ${gizliKelime.toUpperCase()}`;
        msg.className = "text-danger fw-bold";
        document.getElementById("yenidenBtn").classList.remove("d-none");
      } else {
        msg.textContent = `Kalan tahmin hakkı: ${maxTahmin - tahminSayisi}`;
        msg.className = "";
      }
    }

    function oyunuYenidenBaslat() {
      gizliKelime = "";
      tahminSayisi = 0;
      document.getElementById("wordleInput").value = "";
      document.getElementById("wordleContainer").innerHTML = "";
      document.getElementById("wordleMessage").textContent = "Oyunu yeniden başlatabilirsiniz.";
      document.getElementById("yenidenBtn").classList.add("d-none");
    }

    // --- 7. El Yazısı Çizimi ---
    const canvas = document.getElementById("drawCanvas");
   const ctx = canvas.getContext("2d", { willReadFrequently: true });

    let çizim = false;
    let lastX = 0;
    let lastY = 0;

    ctx.strokeStyle = "#000";
    ctx.lineWidth = 3;
    ctx.lineCap = "round";

    function basla(e) {
      çizim = true;
      const rect = canvas.getBoundingClientRect();
      lastX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
      lastY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
    }
    function çiz(e) {
      if (!çizim) return;
      const rect = canvas.getBoundingClientRect();
      const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
      const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(x, y);
      ctx.stroke();
      lastX = x;
      lastY = y;
      guncelleCizimIstatistik();
    }
    function bitir() {
      çizim = false;
    }
    canvas.addEventListener("mousedown", basla);
    canvas.addEventListener("touchstart", basla);
    canvas.addEventListener("mousemove", çiz);
    canvas.addEventListener("touchmove", çiz);
    canvas.addEventListener("mouseup", bitir);
    canvas.addEventListener("mouseleave", bitir);
    canvas.addEventListener("touchend", bitir);
    canvas.addEventListener("touchcancel", bitir);

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      guncelleCizimIstatistik();
    }

    // --- 8. PDF İndirme ---
    async function indirPDF() {
      if (typeof window.jspdf === "undefined" && typeof window.jspdf === "undefined") {
        alert("PDF kütüphanesi henüz yüklenmedi, biraz bekleyip tekrar deneyin.");
        return;
      }
      // jsPDF hazırsa işle
      const { jsPDF } = window.jspdf || window.jspdf;

      const pdf = new jsPDF({
        orientation: "landscape",
        unit: "pt",
        format: [canvas.width, canvas.height]
      });

      const imgData = canvas.toDataURL("image/png");
      pdf.addImage(imgData, "PNG", 0, 0, canvas.width, canvas.height);
      pdf.save("el_yazisi.pdf");
    }

    // --- 9. Çizim İstatistikleri ---
    function guncelleCizimIstatistik() {
      const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      let count = 0;
      for (let i = 0; i < imgData.data.length; i += 4) {
        const alpha = imgData.data[i + 3];
        if (alpha > 10) count++;
      }
      document.getElementById("cizimPiksel").textContent = count;
    }
    guncelleCizimIstatistik();

    // --- 10. Output İçeriği değiştiğinde Latin ve İstatistik güncelle ---
    output.addEventListener("input", guncelleLatinVeIst);

    // --- Başlangıç ---
    guncelleLatinVeIst();
  </script>

</body>
</html>

