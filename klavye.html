<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>OsmanlÄ±ca Klavye + El YazÄ±sÄ± + BaÄŸlÄ± YazÄ±m + DÃ¼zen SeÃ§imi + TarihÃ® Metinler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
  
  <style>
    body {
      font-family: 'Lateef', serif;
      background: linear-gradient(to right, #1a3b5d, #3f5b82);
      color: white;
      padding: 1rem;
    }
    #outputArea {
      direction: rtl;
      font-size: 2rem;
      min-height: 100px;
      white-space: pre-wrap;
      word-break: break-word;
    }
    #harfBilgiKutusu {
      direction: rtl;
      margin-bottom: 1rem;
    }
    .back-home-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      font-size: 1.6rem;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      background-color: #c9a343;
      color: #000;
      border: none;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .back-home-btn:hover {
      transform: scale(1.1);
      background-color: #e5c06d;
      color: #000;
    }
    #klavye button {
      min-width: 3.5rem;
      min-height: 3.5rem;
      font-size: 1.8rem;
      user-select: none;
    }
    #canvasContainer {
      background: #2c4a72;
      border-radius: 8px;
      margin-top: 1rem;
      padding: 10px;
      text-align: center;
    }
    canvas {
      border: 2px solid #e5c06d;
      border-radius: 8px;
      touch-action: none;
      background: white;
      border-radius: 8px;
    }
    .btn-clear, .btn-recognize {
      min-width: 100px;
    }
    /* TarihÃ® metinler listesinde hover efekti */
    #metinListesi li:hover {
      background: rgba(255, 255, 255, 0.15);
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="container">

  <h2 class="text-center text-warning mb-3">ğŸ“± OsmanlÄ±ca Dokunmatik Klavye + El YazÄ±sÄ± + BaÄŸlÄ± YazÄ±m + DÃ¼zen SeÃ§imi + TarihÃ® Metinler</h2>
  
  <!-- Klavye DÃ¼zeni SeÃ§imi -->
  <div class="mb-3 text-center">
    <label for="klavyeSecim" class="form-label">Klavye DÃ¼zeni SeÃ§:</label>
    <select id="klavyeSecim" class="form-select w-auto d-inline-block">
      <option value="standart" selected>Standart</option>
      <option value="alternatif">Alternatif</option>
    </select>
  </div>
  
  <!-- Output -->
  <div id="outputArea" contenteditable="true" class="form-control mb-3" aria-label="OsmanlÄ±ca yazÄ± alanÄ±"></div>
  
  <!-- Harf Bilgisi Kutusu -->
  <div id="harfBilgiKutusu" class="alert alert-info d-none" role="alert"></div>
  
  <!-- TuÅŸlar -->
  <div id="klavye" class="text-center mb-4">
    <div class="d-flex flex-wrap justify-content-center gap-2"></div>
  </div>
  
  <!-- El YazÄ±sÄ± Ã‡izim AlanÄ± -->
  <div id="canvasContainer">
    <h5 class="text-warning">âœï¸ El YazÄ±sÄ± ile Harf Ã‡izimi</h5>
    <canvas id="canvas" width="300" height="150" aria-label="El yazÄ±sÄ± Ã§izim alanÄ±"></canvas>
    <div class="mt-2">
      <button class="btn btn-outline-warning btn-clear me-2" aria-label="Ã‡izim alanÄ±nÄ± temizle"><i class="bi bi-x-circle"></i> Temizle</button>
      <button class="btn btn-warning btn-recognize" disabled aria-label="Ã‡izimi tanÄ±ma (deneme)"><i class="bi bi-check-circle"></i> TanÄ±ma (Deneme)</button>
      <span class="text-muted small">* Otomatik tanÄ±ma yok, Ã§izim kontrolÃ¼ yapÄ±labilir.</span>
    </div>
  </div>

  <!-- TarihÃ® Metin Ã–rnekleri -->
  <div class="card bg-light text-dark mt-4 mb-4">
    <div class="card-body" style="max-height:200px; overflow-y:auto; font-size:1.3rem; direction:rtl;">
      <h5 class="card-title text-center">ğŸ“œ TarihÃ® Metin Ã–rnekleri</h5>
      <ul id="metinListesi" class="list-unstyled" style="user-select:none; padding-left:0;">
        <!-- Ã–rnekler JS ile yÃ¼klenecek -->
      </ul>
    </div>
  </div>

</div>

<!-- Ana Sayfa Butonu -->
<a href="index.html" class="btn btn-warning back-home-btn" title="Ana Sayfaya DÃ¶n">
  <i class="bi bi-house-door-fill"></i>
</a>

<script>
  // 1. Harf Bilgileri (Standart DÃ¼zen iÃ§in)
  const harfBilgileri = {
    "Ø§": "Elif â€“ Genellikle baÅŸta kullanÄ±lÄ±r.",
    "Ø¨": "Be â€“ Dudak sesi. BaÅŸta: Ø¨Ù€ Ortada: Ù€Ø¨Ù€ Sonda: Ù€Ø¨",
    "Øª": "Te â€“ DiÅŸ sesi.",
    "Ø«": "Se â€“ Ä°nce diÅŸ sesi.",
    "Ø¬": "Cim â€“ BoÄŸazdan gelen â€˜câ€™ sesi.",
    "Ø­": "Ha â€“ HÄ±rÄ±ltÄ±lÄ± â€˜hâ€™ sesi.",
    "Ø®": "HÄ± â€“ KalÄ±n â€˜hâ€™ sesi.",
    "Ø¯": "Dal â€“ D sesi.",
    "Ø°": "Zel â€“ Z sesi (ince).",
    "Ø±": "Re â€“ R sesi.",
    "Ø²": "Ze â€“ Sert Z.",
    "Ø³": "Sin â€“ S sesi.",
    "Ø´": "Åin â€“ Å sesi.",
    "Øµ": "Sad â€“ KalÄ±n S.",
    "Ø¶": "Dad â€“ KalÄ±n D.",
    "Ø·": "TÄ± â€“ KalÄ±n T.",
    "Ø¸": "ZÄ± â€“ KalÄ±n Z.",
    "Ø¹": "Ayn â€“ BoÄŸazdan gelen ses.",
    "Øº": "Gayn â€“ GÄ±rtlaktan gelen g sesi.",
    "Ù": "Fe â€“ F sesi.",
    "Ù‚": "Kaf â€“ KalÄ±n K.",
    "Ùƒ": "Kef â€“ Ä°nce K.",
    "Ù„": "Lam â€“ L sesi.",
    "Ù…": "Mim â€“ M sesi.",
    "Ù†": "Nun â€“ N sesi.",
    "Ù‡": "He â€“ H sesi.",
    "Ùˆ": "Vav â€“ V veya U/O sesi.",
    "ÙŠ": "Ye â€“ Y sesi.",
    "Ø¡": "Hemze â€“ Durak sesi.",
    "ØŒ": "VirgÃ¼l",
    ".": "Nokta",
    "â—€": "Silme tuÅŸu"
  };

  // Alternatif DÃ¼zen (Ã¶rnek)
  const harfBilgileriAlternatif = {
    "Ø§": "Elif â€“ Genellikle baÅŸta kullanÄ±lÄ±r.",
    "Ø¨": "Be â€“ Dudak sesi.",
    "Øª": "Te â€“ DiÅŸ sesi.",
    "Ø«": "Se â€“ Ä°nce diÅŸ sesi.",
    "Ø¯": "Dal â€“ D sesi.",
    "Ø±": "Re â€“ R sesi.",
    "Ø²": "Ze â€“ Sert Z.",
    "Ø³": "Sin â€“ S sesi.",
    "Ø´": "Åin â€“ Å sesi.",
    "Øµ": "Sad â€“ KalÄ±n S.",
    "Ø¶": "Dad â€“ KalÄ±n D.",
    "Ø·": "TÄ± â€“ KalÄ±n T.",
    "Ø¸": "ZÄ± â€“ KalÄ±n Z.",
    "Ø¹": "Ayn â€“ BoÄŸazdan gelen ses.",
    "Ù": "Fe â€“ F sesi.",
    "Ù‚": "Kaf â€“ KalÄ±n K.",
    "Ùƒ": "Kef â€“ Ä°nce K.",
    "Ù„": "Lam â€“ L sesi.",
    "Ù…": "Mim â€“ M sesi.",
    "Ù†": "Nun â€“ N sesi.",
    "Ù‡": "He â€“ H sesi.",
    "Ùˆ": "Vav â€“ V veya U/O sesi.",
    "ÙŠ": "Ye â€“ Y sesi.",
    "Ø¡": "Hemze â€“ Durak sesi.",
    "ØŒ": "VirgÃ¼l",
    ".": "Nokta",
    "â—€": "Silme tuÅŸu"
  };

  // 2. Harflerin BaÄŸlantÄ±lÄ± YazÄ±mÄ± - Unicode sunum formlarÄ± (Ã¶rnek, basitleÅŸtirilmiÅŸ)
  const harfFormlari = {
    "Ø§": {isolated: "\u0627", initial: "\uFE8D", medial: "\uFE8D", final: "\uFE8E", connects: false}, 
    "Ø¨": {isolated: "\u0628", initial: "\uFE91", medial: "\uFE92", final: "\uFE90", connects: true}, 
    "Øª": {isolated: "\u062A", initial: "\uFE97", medial: "\uFE98", final: "\uFE96", connects: true}, 
    "Ø«": {isolated: "\u062B", initial: "\uFE9B", medial: "\uFE9C", final: "\uFE9A", connects: true},
    "Ø¬": {isolated: "\u062C", initial: "\uFE9F", medial: "\uFEA0", final: "\uFE9E", connects: true},
    "Ø­": {isolated: "\u062D", initial: "\uFEA3", medial: "\uFEA4", final: "\uFEA2", connects: true},
    "Ø®": {isolated: "\u062E", initial: "\uFEA7", medial: "\uFEA8", final: "\uFEA6", connects: true},
    "Ø¯": {isolated: "\u062F", initial: "\uFEA9", medial: "\uFEAA", final: "\uFEA8", connects: false},
    "Ø°": {isolated: "\u0630", initial: "\uFEAB", medial: "\uFEAC", final: "\uFEAA", connects: false},
    "Ø±": {isolated: "\u0631", initial: "\uFEAD", medial: "\uFEAE", final: "\uFEAC", connects: false},
    "Ø²": {isolated: "\u0632", initial: "\uFEAF", medial: "\uFEB0", final: "\uFEAE", connects: false},
    "Ø³": {isolated: "\u0633", initial: "\uFEB3", medial: "\uFEB4", final: "\uFEB2", connects: true},
    "Ø´": {isolated: "\u0634", initial: "\uFEB7", medial: "\uFEB8", final: "\uFEB6", connects: true},
    "Øµ": {isolated: "\u0635", initial: "\uFEBB", medial: "\uFEBC", final: "\uFEBA", connects: true},
    "Ø¶": {isolated: "\u0636", initial: "\uFEBF", medial: "\uFEC0", final: "\uFEBE", connects: true},
    "Ø·": {isolated: "\u0637", initial: "\uFEC3", medial: "\uFEC4", final: "\uFEC2", connects: true},
    "Ø¸": {isolated: "\u0638", initial: "\uFEC7", medial: "\uFEC8", final: "\uFEC6", connects: true},
    "Ø¹": {isolated: "\u0639", initial: "\uFECB", medial: "\uFECC", final: "\uFECA", connects: true},
    "Øº": {isolated: "\u063A", initial: "\uFECF", medial: "\uFED0", final: "\uFECE", connects: true},
    "Ù": {isolated: "\u0641", initial: "\uFED3", medial: "\uFED4", final: "\uFED2", connects: true},
    "Ù‚": {isolated: "\u0642", initial: "\uFED7", medial: "\uFED8", final: "\uFED6", connects: true},
    "Ùƒ": {isolated: "\u0643", initial: "\uFEDB", medial: "\uFEDC", final: "\uFEDA", connects: true},
    "Ù„": {isolated: "\u0644", initial: "\uFEDF", medial: "\uFEE0", final: "\uFEDE", connects: true},
    "Ù…": {isolated: "\u0645", initial: "\uFEE3", medial: "\uFEE4", final: "\uFEE2", connects: true},
    "Ù†": {isolated: "\u0646", initial: "\uFEE7", medial: "\uFEE8", final: "\uFEE6", connects: true},
    "Ù‡": {isolated: "\u0647", initial: "\uFEEB", medial: "\uFEEC", final: "\uFEEA", connects: true},
    "Ùˆ": {isolated: "\u0648", initial: "\uFEED", medial: "\uFEEE", final: "\uFEEC", connects: false},
    "ÙŠ": {isolated: "\u064A", initial: "\uFEF3", medial: "\uFEF4", final: "\uFEF2", connects: true},
    "Ø¡": {isolated: "\u0621", initial: "\uFE80", medial: "\uFE80", final: "\uFE80", connects: false},
    "ØŒ": {isolated: "ØŒ", initial: "ØŒ", medial: "ØŒ", final: "ØŒ", connects: false},
    ".": {isolated: ".", initial: ".", medial: ".", final: ".", connects: false},
    "â—€": {isolated: "â—€", initial: "â—€", medial: "â—€", final: "â—€", connects: false}
  };

  // BaÄŸlÄ± yazÄ±m iÃ§in fonksiyon
  function biyeBagla(metin) {
    let chars = metin.split('');
    let sonucDizisi = [];

    for (let i = 0; i < chars.length; i++) {
      const simdiki = chars[i];
      const onceki = chars[i - 1];
      const sonraki = chars[i + 1];

      const simdikiFormlar = harfFormlari[simdiki];
      if (!simdikiFormlar) {
        // Harf bulunmazsa direkt ekle
        sonucDizisi.push(simdiki);
        continue;
      }

      const oncekiBaglanir = onceki && harfFormlari[onceki] && harfFormlari[onceki].connects;
      const sonrakiBaglanir = sonraki && harfFormlari[sonraki] && harfFormlari[sonraki].connects;

      let form = simdikiFormlar.isolated;

      if (oncekiBaglanir && sonrakiBaglanir && simdikiFormlar.medial) {
        form = simdikiFormlar.medial;
      } else if (oncekiBaglanir && simdikiFormlar.final) {
        form = simdikiFormlar.final;
      } else if (sonrakiBaglanir && simdikiFormlar.initial) {
        form = simdikiFormlar.initial;
      }

      sonucDizisi.push(form);
    }

    return sonucDizisi.join('');
  }

  // 3. Klavye DÃ¼zenleri (tuÅŸ dizileri)
  const klavyeDÃ¼zenleri = {
    standart: ["Ø§","Ø¨","Øª","Ø«","Ø¬","Ø­","Ø®","Ø¯","Ø°","Ø±","Ø²","Ø³","Ø´","Øµ","Ø¶","Ø·","Ø¸","Ø¹","Øº","Ù","Ù‚","Ùƒ","Ù„","Ù…","Ù†","Ù‡","Ùˆ","ÙŠ","Ø¡","ØŒ",".","â—€"],
    alternatif: ["Ø§","Ø¨","Øª","Ø«","Ø¯","Ø±","Ø²","Ø³","Ø´","Øµ","Ø¶","Ø·","Ø¸","Ø¹","Ù","Ù‚","Ùƒ","Ù„","Ù…","Ù†","Ù‡","Ùˆ","ÙŠ","Ø¡","ØŒ",".","â—€"]
  };

  const klavyeDiv = document.querySelector("#klavye .d-flex");
  const harfBilgiKutusu = document.getElementById("harfBilgiKutusu");
  const output = document.getElementById("outputArea");
  const klavyeSecim = document.getElementById("klavyeSecim");
  const sonuc = document.createElement("div"); // boÅŸ, kontrol mesajlarÄ±nÄ± burada gÃ¶steriyoruz

  // Klavyeyi Ã§iz
  function klavyeOlustur(dÃ¼zen) {
    klavyeDiv.innerHTML = "";
    const harfBilgiKaynak = dÃ¼zen === klavyeDÃ¼zenleri.standart ? harfBilgileri : harfBilgileriAlternatif;
    dÃ¼zen.forEach(harf => {
      const btn = document.createElement("button");
      btn.className = "btn btn-outline-light";
      btn.textContent = harf;
      btn.setAttribute("aria-label", harfBilgiKaynak[harf] || "Harfi yaz");
      btn.onclick = () => {
        if (harf === "â—€") {
          let metin = output.innerText;
          metin = metin.slice(0, -1);
          output.innerText = biyeBagla(metin);
        } else {
          let metin = output.innerText + harf;
          output.innerText = biyeBagla(metin);
        }
        harfBilgiKutusu.classList.remove("d-none");
        harfBilgiKutusu.textContent = harfBilgiKaynak[harf] || "";
        sonuc.textContent = "";
        output.focus();
      };
      klavyeDiv.appendChild(btn);
    });
  }

  klavyeOlustur(klavyeDÃ¼zenleri.standart);

  klavyeSecim.addEventListener("change", () => {
    const secim = klavyeSecim.value;
    if (secim === "standart") {
      klavyeOlustur(klavyeDÃ¼zenleri.standart);
    } else {
      klavyeOlustur(klavyeDÃ¼zenleri.alternatif);
    }
    harfBilgiKutusu.classList.add("d-none");
    output.innerText = "";
    sonuc.textContent = "";
  });

  // Output alanÄ± manuel deÄŸiÅŸince (Ã¶r: yapÄ±ÅŸtÄ±rma) baÄŸlÄ± yazÄ±mÄ± uygula
  output.addEventListener("input", () => {
    const val = output.innerText;
    output.innerText = biyeBagla(val);
    placeCaretAtEnd(output);
  });

  // Caret (imleÃ§) sonuna konumlandÄ±rma
  function placeCaretAtEnd(el) {
    el.focus();
    if (typeof window.getSelection != "undefined" && typeof document.createRange != "undefined") {
      const range = document.createRange();
      range.selectNodeContents(el);
      range.collapse(false);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    }
  }

  // -----------------------------------
  // 1. El YazÄ±sÄ± Ã‡izim AlanÄ± (Canvas)
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  let Ã§izimAktif = false;
  let Ã§izimYol = [];

  function canvasTemizle() {
    ctx.fillStyle = "white";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    Ã§izimYol = [];
    btnRecognize.disabled = true;
  }

  canvasTemizle();

  function getPointerPos(e) {
    let rect = canvas.getBoundingClientRect();
    let x, y;
    if (e.touches) {
      x = e.touches[0].clientX - rect.left;
      y = e.touches[0].clientY - rect.top;
    } else {
      x = e.clientX - rect.left;
      y = e.clientY - rect.top;
    }
    return {x, y};
  }

  function basla(e) {
    e.preventDefault();
    Ã§izimAktif = true;
    Ã§izimYol.push([]);
    let pos = getPointerPos(e);
    Ã§izimYol[Ã§izimYol.length - 1].push(pos);
    ctx.strokeStyle = "black";
    ctx.lineWidth = 6;
    ctx.lineCap = "round";
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
    btnRecognize.disabled = false;
  }

  function Ã§izim(e) {
    if (!Ã§izimAktif) return;
    e.preventDefault();
    let pos = getPointerPos(e);
    Ã§izimYol[Ã§izimYol.length - 1].push(pos);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
  }

  function bitir(e) {
    if (!Ã§izimAktif) return;
    e.preventDefault();
    Ã§izimAktif = false;
    ctx.closePath();
  }

  // Event listenerlar
  canvas.addEventListener("mousedown", basla);
  canvas.addEventListener("mousemove", Ã§izim);
  canvas.addEventListener("mouseup", bitir);
  canvas.addEventListener("mouseout", bitir);
  canvas.addEventListener("touchstart", basla);
  canvas.addEventListener("touchmove", Ã§izim);
  canvas.addEventListener("touchend", bitir);
  canvas.addEventListener("touchcancel", bitir);

  const btnClear = document.querySelector(".btn-clear");
  const btnRecognize = document.querySelector(".btn-recognize");

  btnClear.addEventListener("click", () => {
    canvasTemizle();
  });

  btnRecognize.addEventListener("click", () => {
    alert("Åu anda otomatik el yazÄ±sÄ± tanÄ±ma yok.\n\nÃ‡izdiÄŸiniz harfi gÃ¶zlemleyin ve klavyeden yazabilirsiniz.");
  });

  // -----------------------------------
  // 4. TarihÃ® Metin Ã–rnekleri
  const tarihMetinleri = [
    {
      osmanlica: "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ Ø±Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠÙ†",
      turkce: "Alemlerin Rabbi Allahâ€™a hamdolsun."
    },
    {
      osmanlica: "Ù‡Ø°Ø§ ÙƒØªØ§Ø¨ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©",
      turkce: "Bu okulun kitabÄ±dÄ±r."
    },
    {
      osmanlica: "Ù…Ø³Ø¬Ø¯ Ø§Ù„Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯",
      turkce: "Yeni Sultan Camii."
    },
    {
      osmanlica: "ÙƒØªØ¨ Ø§Ù„Ù…Ø¤Ø±Ø® ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®",
      turkce: "TarihÃ§i tarih Ã¼zerine yazdÄ±."
    },
    {
      osmanlica: "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„ØºØ© Ø§Ù„Ù‚Ø±Ø¢Ù†",
      turkce: "ArapÃ§a, Kuranâ€™Ä±n dilidir."
    }
  ];

  const metinListesi = document.getElementById("metinListesi");

  function metinleriYukle() {
    tarihMetinleri.forEach((metin, i) => {
      const li = document.createElement("li");
      li.innerHTML = `<strong style="font-size:1.4rem;">${metin.osmanlica}</strong><br><small>${metin.turkce}</small>`;
      li.classList.add("p-2", "border-bottom");
      li.style.userSelect = "none";
      li.addEventListener("click", () => {
        output.innerText = metin.osmanlica;
        output.innerText = biyeBagla(output.innerText); // BaÄŸlÄ± yazÄ±mÄ± uygula
        harfBilgiKutusu.classList.add("d-none");
        sonuc.textContent = "";
        output.focus();
      });
      metinListesi.appendChild(li);
    });
  }
  metinleriYukle();

</script>

</body>
</html>
